# 2025-07-13-01: Fix Missing Resource Fields - Add intro and short_description

## Problem

AI resource generation was creating two important fields that were being completely lost:

- `intro` - A book introduction that prepares readers for the content structure and approach
- `short_description` - A one-sentence hook designed for lists and previews

These fields were generated by AI during resource creation but were:

- ❌ Not saved to the database (missing columns)
- ❌ Not editable in the interface (missing form fields)
- ❌ Lost forever after the initial generation

## Solution

Added complete support for these fields throughout the system:

### Database Changes

- **Migration**: `2025-07-13.12-00.add-intro-short-description-to-resources.ts`
  - Added `intro` column (text NOT NULL DEFAULT '')
  - Added `short_description` column (text NOT NULL DEFAULT '')
  - Set existing resources to empty strings

### Type Updates

- **Database Types**: Updated `shared/src/database.d.ts` Resources interface
- **Function Types**: Updated `saveResource` and `updateResource` parameter types

### Backend Updates

- **Save Function**: Updated `web/lib/db/resources.ts` to handle new required fields
- **Server Actions**: Already compatible via `UpdateResource` type

### Frontend Updates

- **Edit Interface**: Added form fields to `web/app/resources/[id]/edit/page.tsx`
  - `short_description`: Input field with placeholder
  - `intro`: Textarea field with placeholder
- **Create Preview**: Added fields to `web/app/resources/create/page.tsx`
  - Shows AI-generated values for review before saving
- **Resource Display**: Updated user-facing pages to show new fields
  - `web/app/resources/[id]/page.tsx`: Added intro section, use short_description in header
  - `web/app/resources/page.tsx`: Use short_description in resource list (fallback to description)

## Technical Details

### Field Types & Requirements

- `intro`: Markdown string (required, NOT NULL)
- `short_description`: Plain string (required, NOT NULL)
- Both fields default to empty strings for existing resources

### UI Placement

Edit form field order:

1. Name
2. Short Description (with helpful placeholder)
3. Introduction (with helpful placeholder)
4. Description (full content)
5. Cover & Tint

## CLAUDE.md Updates

Updated Tables section to reflect new resource schema:

```diff
- resources → id, name, description (markdown), cover (image url), tint (color value)
+ resources → id, name, description (markdown), intro (markdown), short_description (string), cover (image url), tint (color value)
```

## Impact

- ✅ AI-generated intro and short_description content is now preserved
- ✅ Admins can edit these fields in the resource editor
- ✅ Resource creation flow shows all generated fields for review
- ✅ Users see intro content on individual resource pages
- ✅ Resource lists use concise short_description for better discovery
- ✅ Complete type safety maintained throughout the system
- ✅ No data loss during resource generation process
